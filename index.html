<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caim√°nCuentacuentos Pro üêä</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root { --p: #2e7d32; --s: #ffa000; --blue: #1565c0; }
        body { font-family: 'Comic Sans MS', cursive, sans-serif; background: #e8f5e9; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .card { max-width: 750px; width: 100%; background: white; padding: 30px; border-radius: 30px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); text-align: center; border: 8px solid #c8e6c9; }
        h1 { color: var(--p); font-size: 2.2em; margin-bottom: 5px; }
        .input-group { background: #fff3e0; padding: 20px; border-radius: 20px; margin: 20px 0; border: 2px dashed var(--s); }
        input[type="text"] { width: 85%; padding: 12px; border-radius: 12px; border: 2px solid #ddd; margin: 5px 0; font-size: 1.1em; }
        
        /* ZONA DE DIBUJO SIEMPRE VISIBLE */
        #canvas-wrap { border: 6px solid var(--p); border-radius: 20px; margin: 20px 0; background: white; overflow: hidden; }
        canvas { display: block; max-width: 100%; height: auto; cursor: crosshair; background: white; }
        
        .btn-zone { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-top: 15px; }
        button { padding: 12px 25px; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; color: white; text-transform: uppercase; }
        
        /* COLORES DE BOTONES SEG√öN TU IMAGEN */
        .btn-main { background: var(--p); box-shadow: 0 4px 0 #1b5e20; }
        .btn-nav { background: #555; box-shadow: 0 4px 0 #333; }
        .btn-share { background: var(--blue); box-shadow: 0 4px 0 #0d47a1; } /* BOT√ìN AZUL */
        .btn-pdf { background: var(--s); color: #333; box-shadow: 0 4px 0 #e65100; } /* BOT√ìN NARANJA */
        
        button:active { transform: translateY(4px); box-shadow: none; }
        #story-txt { font-size: 1.2em; margin: 15px 0; color: #333; font-weight: bold; }
        hr { border: 0; border-top: 2px solid #eee; margin: 25px 0; width: 100%; }
    </style>
</head>
<body>

<div class="card">
    <h1>üêä Caim√°nCuentacuentos</h1>
    
    <div class="input-group">
        <input type="text" id="author" placeholder="Nombre de la autora">
        <input type="text" id="topic" placeholder="Ej: Un caim√°n que quiere volar...">
        <div class="btn-zone">
            <button class="btn-main" onclick="generar()">‚ú® CREAR CUENTO M√ÅGICO</button>
        </div>
    </div>

    <div id="book-viewer">
        <h2 id="page-label">Bienvenido</h2>
        <div id="story-txt">Escribe los datos arriba para empezar.</div>
        
        <div id="canvas-wrap">
            <canvas id="paintCanvas" width="600" height="400"></canvas>
        </div>

        <div class="btn-zone">
            <button class="btn-nav" onclick="move(-1)">‚¨ÖÔ∏è Anterior</button>
            <input type="color" id="brushColor" value="#2e7d32" style="width:50px; height:45px; border:none; cursor:pointer;">
            <button class="btn-nav" onclick="limpiar()">üßπ Borrar</button>
            <button class="btn-nav" onclick="move(1)">Siguiente ‚û°Ô∏è</button>
        </div>

        <hr>

        <div id="final-zone">
            <h3 id="txt-autor" style="color: var(--p)">¬°Libro en proceso!</h3>
            <div class="btn-zone">
                <button class="btn-share" onclick="compartir()">üìã COPIAR ENLACE PARA EL NI√ëO</button>
                <button class="btn-pdf" onclick="descargar()">üì• GUARDAR COMO PDF</button>
            </div>
        </div>
    </div>
</div>

<script>
    // Variables b√°sicas
    let book = { pages: ["Portada de prueba", "P√°gina 1", "P√°gina 2", "P√°gina 3", "P√°gina 4", "Fin"], cur: 0 };
    const canv = document.getElementById('paintCanvas');
    const ctx = canv.getContext('2d');
    let drawing = false;

    // Pintar (Siempre activo para que pruebes)
    canv.onmousedown = (e) => { drawing = true; paint(e); };
    canv.onmouseup = () => { drawing = false; ctx.beginPath(); };
    canv.onmousemove = (e) => { if(drawing) paint(e); };

    function paint(e) {
        ctx.strokeStyle = document.getElementById('brushColor').value;
        ctx.lineWidth = 5; ctx.lineCap = 'round';
        const r = canv.getBoundingClientRect();
        ctx.lineTo(e.clientX - r.left, e.clientY - r.top);
        ctx.stroke();
    }

    function move(dir) {
        book.cur = Math.max(0, Math.min(5, book.cur + dir));
        document.getElementById('page-label').innerText = book.cur === 0 ? "üìñ PORTADA" : `P√ÅGINA ${book.cur}`;
        document.getElementById('story-txt').innerText = book.pages[book.cur];
        ctx.clearRect(0,0,600,400); // Limpia para simular cambio de p√°gina
    }

    function generar() {
        const nombre = document.getElementById('author').value || "Autora";
        document.getElementById('txt-autor').innerText = "Escrito por: " + nombre;
        alert("¬°Generando modo visual! Mira los botones abajo.");
    }

    function limpiar() { ctx.clearRect(0,0,600,400); }

    function compartir() { alert("Enlace copiado (Modo visual)"); }

    function descargar() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF('l', 'mm', [210, 148]);
        doc.text("Mi Cuento Pro", 105, 20, {align: 'center'});
        doc.save("Cuento.pdf");
    }
</script>
</body>
</html>
